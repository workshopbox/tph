<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TPH Calculator V2 - DAP8</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <svg width="40" height="40" viewBox="0 0 40 40" fill="none">
                    <path d="M20 5L35 12.5V27.5L20 35L5 27.5V12.5L20 5Z" fill="#FF9900" stroke="#232F3E" stroke-width="2"/>
                    <text x="20" y="26" text-anchor="middle" fill="#232F3E" font-family="Arial" font-weight="bold" font-size="16">D8</text>
                </svg>
                <div>
                    <h1>TPH Calculator V2.0</h1>
                    <span class="station-badge">DAP8 Steiermark</span>
                </div>
            </div>
            <div class="header-actions">
                <button class="btn-secondary" onclick="app.exportData()">Export</button>
                <button class="btn-secondary" onclick="app.resetData()">Reset</button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        
        <!-- Upload Section -->
        <section class="card upload-card" id="upload-section">
            <div class="card-header">
                <h2>üìä Import Horizon Data</h2>
                <p>Upload weekly forecast files to begin</p>
            </div>
            <div class="card-body">
                <div class="upload-grid">
                    <div class="upload-area" id="box-alpx" onclick="document.getElementById('file-alpx').click()">
                        <div class="upload-icon">üìÑ</div>
                        <h3>horizon_alpx.csv</h3>
                        <p>Volume & hours data</p>
                        <span class="upload-status" id="status-alpx">Click to upload</span>
                    </div>
                    <div class="upload-area" id="box-table" onclick="document.getElementById('file-table').click()">
                        <div class="upload-icon">‚öôÔ∏è</div>
                        <h3>horizon_table.csv</h3>
                        <p>Rate configuration</p>
                        <span class="upload-status" id="status-table">Click to upload</span>
                    </div>
                </div>
                <input type="file" id="file-alpx" accept=".csv" style="display: none;">
                <input type="file" id="file-table" accept=".csv" style="display: none;">
                <div class="upload-actions">
                    <button class="btn-primary" id="import-btn" disabled>
                        <span>Process Data</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Loading -->
        <div class="loading-overlay" id="loading">
            <div class="spinner"></div>
            <p>Processing data...</p>
        </div>

        <!-- Date Selector Section -->
        <section class="card" id="selector-section" style="display: none;">
            <div class="card-header">
                <h2>üìÖ Select View Period</h2>
            </div>
            <div class="card-body">
                <div class="selector-controls">
                    <div class="view-mode-selector">
                        <label class="radio-btn">
                            <input type="radio" name="view-mode" value="weekly" checked onchange="app.changeViewMode('weekly')">
                            <span>Weekly View</span>
                        </label>
                        <label class="radio-btn">
                            <input type="radio" name="view-mode" value="daily" onchange="app.changeViewMode('daily')">
                            <span>Daily View</span>
                        </label>
                    </div>
                    
                    <div class="period-selector" id="weekly-selector">
                        <label>Select Week:</label>
                        <select id="week-select" onchange="app.loadWeek()"></select>
                        <span id="week-info"></span>
                    </div>
                    
                    <div class="period-selector" id="daily-selector" style="display: none;">
                        <label>Select Date:</label>
                        <select id="date-select" onchange="app.loadDate()"></select>
                        <span id="date-info"></span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Volume Section -->
        <section class="card" id="volume-section" style="display: none;">
            <div class="card-header">
                <h2>üì¶ Volume Configuration</h2>
                <p id="volume-label">Current Period Volume</p>
            </div>
            <div class="card-body">
                <div class="volume-control">
                    <div class="input-group">
                        <input type="number" id="volume-input" value="0" min="0" step="1000">
                        <span class="input-suffix">packages</span>
                        <button class="btn-secondary" onclick="app.recalculate()">
                            <span>‚Üª Recalculate</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Results Cards -->
        <section class="metrics-grid" id="metrics-section" style="display: none;">
            <div class="metric-card">
                <div class="metric-label" id="metric-label-current">Current TPH</div>
                <div class="metric-value" id="current-tph">--</div>
                <div class="metric-change neutral">Baseline</div>
            </div>
            <div class="metric-card highlight">
                <div class="metric-label" id="metric-label-new">Optimized TPH</div>
                <div class="metric-value" id="new-tph">--</div>
                <div class="metric-change" id="improvement-text">No changes</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Delta</div>
                <div class="metric-value" id="improvement">--</div>
                <div class="metric-change neutral">Change</div>
            </div>
            <div class="metric-card highlight">
                <div class="metric-label">Hours Saved</div>
                <div class="metric-value" id="hours-saved">--</div>
                <div class="metric-change" id="cost-saved">‚Ç¨0</div>
            </div>
        </section>

        <!-- Calculator Table -->
        <section class="card" id="calculator-section" style="display: none;">
            <div class="card-header">
                <h2>üîß Activity Configuration</h2>
                <p>Adjust rates for selected period</p>
            </div>
            <div class="card-body">
                <div class="table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Activity</th>
                                <th>Sub-Activity</th>
                                <th>Method</th>
                                <th>Current Rate</th>
                                <th>New Config</th>
                                <th>Current Hours</th>
                                <th>New Hours</th>
                            </tr>
                        </thead>
                        <tbody id="tbody"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Analysis Section -->
        <section class="card" id="analysis-section" style="display: none;">
            <div class="card-header">
                <h2>üìà Performance Analysis</h2>
            </div>
            <div class="card-body">
                <div class="target-config">
                    <label>Target TPH Threshold</label>
                    <div class="input-group">
                        <input type="number" id="target-input" value="11.5" step="0.1" min="0">
                        <button class="btn-secondary" onclick="app.updateTarget()">Update</button>
                    </div>
                </div>
                <div class="analysis-content" id="summary"></div>
            </div>
        </section>

    </div>

    <script src="script.js"></script>
</body>
</html>
