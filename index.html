<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horizon Flow | Labor Optimization</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/inter-ui/3.19.3/inter.css" rel="stylesheet">
</head>
<body>
    
    <aside class="sidebar">
        <div class="brand">
            <div class="logo-icon">
                <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 4L36 12V28L20 36L4 28V12L20 4Z" fill="#232F3E"/>
                    <path d="M20 4L36 12V28L20 36" stroke="#FF9900" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M20 14V26M14 17L20 14L26 17M14 23L20 26L26 23" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <div class="brand-text">
                <h1>Horizon Flow</h1>
                <span>DAP8 Analytics</span>
            </div>
        </div>

        <nav class="nav-menu">
            <div class="nav-section">
                <h3>Data Source</h3>
                
                <div class="upload-item" id="box-alpx" onclick="document.getElementById('file-alpx').click()">
                    <div class="upload-icon">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>
                    </div>
                    <div class="upload-info">
                        <span class="file-name">Horizon ALPX</span>
                        <span class="status-dot" id="dot-alpx"></span>
                    </div>
                </div>

                <div class="upload-item" id="box-table" onclick="document.getElementById('file-table').click()">
                    <div class="upload-icon">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg>
                    </div>
                    <div class="upload-info">
                        <span class="file-name">Rate Table</span>
                        <span class="status-dot" id="dot-table"></span>
                    </div>
                </div>

                <input type="file" id="file-alpx" accept=".csv" hidden>
                <input type="file" id="file-table" accept=".csv" hidden>
                
                <button id="import-btn" class="btn-primary full-width" disabled>
                    Load Data Context
                </button>
            </div>

            <div class="nav-section" id="context-selector" style="display: none; opacity: 0;">
                <h3>View Context</h3>
                
                <div class="toggle-group">
                    <button class="toggle-btn active" data-mode="weekly" onclick="app.changeViewMode('weekly')">Weekly</button>
                    <button class="toggle-btn" data-mode="daily" onclick="app.changeViewMode('daily')">Daily</button>
                </div>

                <div class="select-wrapper">
                    <label>Period Selection</label>
                    <select id="week-select" onchange="app.loadWeek()"></select>
                    <select id="date-select" onchange="app.loadDate()" style="display: none;"></select>
                </div>

                <div class="select-wrapper">
                    <label>Target TPH</label>
                    <input type="number" id="target-input" value="11.5" step="0.1" onchange="app.updateTarget()">
                </div>
            </div>
            
            <div class="nav-footer">
                <button class="btn-ghost" onclick="app.resetData()">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2.5 2v6h6M21.5 22v-6h-6"/><path d="M22 11.5A10 10 0 0 0 3.2 7.2M2 12.5a10 10 0 0 0 18.8 4.2"/></svg>
                    Reset
                </button>
                <button class="btn-ghost" onclick="app.exportData()">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                    Export
                </button>
            </div>
        </nav>
    </aside>

    <main class="main-content">
        
        <header class="top-bar">
            <div class="breadcrumbs">
                <span class="station-tag">DAP8</span>
                <span class="separator">/</span>
                <span id="current-period-display">Waiting for data...</span>
            </div>
            <div class="user-actions">
               <span class="team-label">Team:</span>
               <a href="https://phonetool.amazon.com/users/tbadakar" target="_blank" class="user-link">Karim</a>
               <span class="dot">â€¢</span>
               <a href="https://phonetool.amazon.com/users/ozeitsch" target="_blank" class="user-link">Oliver</a>
               <span class="dot">â€¢</span>
               <a href="https://phonetool.amazon.com/users/welmannw" target="_blank" class="user-link">Natasha</a>
            </div>
        </header>

        <div id="loading" class="loading-state">
            <div class="spinner"></div>
            <p>Processing Horizon Data...</p>
        </div>

        <div id="app-interface" style="display: none;">
            <div class="kpi-grid">
                <div class="kpi-card interactive">
                    <div class="kpi-header">
                        <span class="kpi-title">Projected Volume</span>
                        <button class="icon-btn" onclick="app.recalculate()">â†»</button>
                    </div>
                    <div class="volume-input-wrapper">
                        <input type="number" id="volume-input" value="0">
                        <span class="unit">pkgs</span>
                    </div>
                </div>

                <div class="kpi-card">
                    <span class="kpi-title">Current TPH</span>
                    <div class="kpi-value" id="current-tph">--</div>
                    <div class="kpi-trend neutral">Baseline</div>
                </div>

                <div class="kpi-card highlight">
                    <span class="kpi-title">Optimized TPH</span>
                    <div class="kpi-value" id="new-tph">--</div>
                    <div class="kpi-trend" id="improvement-text">--</div>
                </div>

                <div class="kpi-card">
                    <span class="kpi-title">Projected Savings</span>
                    <div class="kpi-value" id="cost-saved">â‚¬0</div>
                    <div class="kpi-sub" id="hours-saved">0 Hrs</div>
                </div>
            </div>

            <div class="workspace">
                <div class="section-header">
                    <h2>Activity Configuration</h2>
                    <div class="filters">
                        <span class="badge-info">Auto-saved</span>
                    </div>
                </div>

                <div class="table-container">
                    <table class="modern-table">
                        <thead>
                            <tr>
                                <th width="15%">Activity</th>
                                <th width="20%">Sub-Activity</th>
                                <th width="15%">Method</th>
                                <th width="10%">Base Rate</th>
                                <th width="20%">Configuration</th>
                                <th width="10%" class="text-right">Base Hrs</th>
                                <th width="10%" class="text-right">New Hrs</th>
                            </tr>
                        </thead>
                        <tbody id="tbody">
                            </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <div id="empty-state" class="empty-state">
            <div class="empty-icon">ðŸ“Š</div>
            <h2>Ready to Analyze</h2>
            <p>Upload the Horizon ALPX and Table CSV files using the sidebar to begin optimization.</p>
        </div>

    </main>

    <script src="script.js"></script>
</body>
</html>